# This is a basic workflow to help you get started with Actions

name: Generate Snake Animation

on:
  # Triggers the workflow on push or pull request events but only for the "main" branch
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:
  
  # Run automatically every 12 hours
  schedule:
    - cron: "0 */12 * * *"

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Generate GitHub Snake animation
        uses: Platane/snk@v3
        with:
          # github user name to read the contribution graph from (**required**)
          github_user_name: ${{ github.repository_owner }}

          # list of files to generate.
          # one file per line. Each output can be customized with options as query string.
          outputs: |
            # Fichier pour le thème clair : serpent noir, points en dégradé de gris
            github-snake.svg?color_snake=black&color_dots=#CCCCCC,#999999,#666666,#333333,#000000
            # Fichier pour le thème sombre : serpent blanc, points en dégradé de gris clair
            github-snake-dark.svg?color_snake=white&color_dots=#FFFFFF,#F0F0F0,#DCDCDC,#C8C8C8,#B4B4B4
            
      - name: Push generated files to repository
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          if [ -f github-snake.svg ] && [ -f github-snake-dark.svg ]; then
            git add github-snake.svg github-snake-dark.svg
            git diff --staged --quiet || git commit -m "Update snake animation"
            git push origin HEAD:main
          else
            echo "Snake animation files were not generated"
            exit 1
          fi
